<!DOCTYPE html>
<html>
<head>
    <title>DEBUG - Data Check</title>
    <style>
        body { font-family: Arial; margin: 20px; font-size: 12px; }
        .debug-box { background: #f0f0f0; padding: 15px; margin: 10px 0; border: 1px solid #ccc; }
        .error { background: #ffcccc; }
        .success { background: #ccffcc; }
    </style>
</head>
<body>
    <h1>üîç DEBUG: Template Data Check</h1>
    
    <!-- Check if debug_info exists -->
    {% if debug_info %}
    <div class="debug-box success">
        <h3>‚úÖ Debug Info Available</h3>
        <p><strong>Data compiled:</strong> {{ debug_info.data_compiled }}</p>
        <p><strong>Sections:</strong> {{ debug_info.sections_available|join:", " }}</p>
        <p><strong>UTC Time:</strong> {{ debug_info.current_time_utc }}</p>
        <p><strong>IST Time:</strong> {{ debug_info.current_time_ist }}</p>
        <p><strong>User:</strong> {{ debug_info.current_user }}</p>
        <p><strong>Project ID:</strong> {{ debug_info.project_id }}</p>
        <p><strong>Template Method:</strong> {{ debug_info.template_context_method|default:"Not specified" }}</p>
    </div>
    {% else %}
    <div class="debug-box error">
        <h3>‚ùå Debug Info Missing</h3>
        <p>Template context may not be properly prepared.</p>
    </div>
    {% endif %}
    
    <!-- Check project_info -->
    {% if project_info %}
    <div class="debug-box success">
        <h3>‚úÖ Project Info Available</h3>
        <p><strong>Customer:</strong> {{ project_info.customer_name|default:"Not found" }}</p>
        <p><strong>Quotation No:</strong> {{ project_info.quotation_number|default:"Not found" }}</p>
        <p><strong>Date:</strong> {{ project_info.quotation_date|default:"Not found" }}</p>
        <p><strong>Time:</strong> {{ project_info.quotation_time|default:"Not found" }} {{ project_info.quotation_timezone|default:"" }}</p>
        <p><strong>Brand:</strong> {{ project_info.brand|default:"Not found" }}</p>
        <p><strong>Generated by:</strong> {{ project_info.generated_by|default:"Not found" }}</p>
        <p><strong>Status:</strong> {{ project_info.status|default:"Not found" }}</p>
        <p><strong>Currency:</strong> {{ project_info.currency|default:"Not found" }}</p>
    </div>
    {% else %}
    <div class="debug-box error">
        <h3>‚ùå Project Info Missing</h3>
        <p>project_info variable not found in template context.</p>
    </div>
    {% endif %}
    
    <!-- Check customer_info -->
    {% if customer_info %}
    <div class="debug-box success">
        <h3>‚úÖ Customer Info Available</h3>
        <p><strong>Name:</strong> {{ customer_info.name|default:"Not found" }}</p>
        <p><strong>Phone:</strong> {{ customer_info.phone|default:"Not found" }}</p>
        <p><strong>Address:</strong> {{ customer_info.address|default:"Not found" }}</p>
        <p><strong>Email:</strong> {{ customer_info.email|default:"Not found" }}</p>
    </div>
    {% else %}
    <div class="debug-box error">
        <h3>‚ùå Customer Info Missing</h3>
        <p>customer_info variable not found in template context.</p>
    </div>
    {% endif %}
    
    <!-- Check calculations -->
    {% if calculations %}
    <div class="debug-box success">
        <h3>‚úÖ Calculations Available</h3>
        <p><strong>Grand Total:</strong> {{ calculations.grand_total|default:"Not found" }}</p>
        <p><strong>Formatted Final Total:</strong> {{ calculations.formatted.final_total|default:"Not found" }}</p>
        <p><strong>GST Amount:</strong> {{ calculations.formatted.gst_amount|default:"Not found" }}</p>
        <p><strong>Subtotal Cabinets:</strong> {{ calculations.formatted.line_items_total|default:"Not found" }}</p>
        <p><strong>Doors Total:</strong> {{ calculations.formatted.doors_total|default:"Not found" }}</p>
        <p><strong>Accessories Total:</strong> {{ calculations.formatted.accessories_total|default:"Not found" }}</p>
    </div>
    {% else %}
    <div class="debug-box error">
        <h3>‚ùå Calculations Missing</h3>
        <p>calculations variable not found in template context.</p>
    </div>
    {% endif %}
    
    <!-- Check cabinet_breakdown -->
    {% if cabinet_breakdown %}
    <div class="debug-box success">
        <h3>‚úÖ Cabinet Breakdown Available</h3>
        <p><strong>Cabinet Count:</strong> {{ cabinet_breakdown|length }}</p>
        {% if cabinet_breakdown|length > 0 %}
            <p><strong>First Cabinet:</strong> {{ cabinet_breakdown.0.name|default:"Name not found" }}</p>
            <p><strong>First Cabinet Category:</strong> {{ cabinet_breakdown.0.category|default:"Category not found" }}</p>
            <p><strong>First Cabinet Brand:</strong> {{ cabinet_breakdown.0.brand|default:"Brand not found" }}</p>
        {% endif %}
    </div>
    {% else %}
    <div class="debug-box error">
        <h3>‚ùå Cabinet Breakdown Missing</h3>
        <p>cabinet_breakdown variable not found or empty.</p>
    </div>
    {% endif %}
    
    <!-- Check accessories_detailed -->
    {% if accessories_detailed %}
    <div class="debug-box success">
        <h3>‚úÖ Accessories Available</h3>
        <p><strong>Accessory Count:</strong> {{ accessories_detailed|length }}</p>
        {% if accessories_detailed|length > 0 %}
            <p><strong>First Accessory:</strong> {{ accessories_detailed.0.name|default:"Name not found" }}</p>
        {% endif %}
    </div>
    {% else %}
    <div class="debug-box error">
        <h3>‚ùå Accessories Missing</h3>
        <p>accessories_detailed variable not found or empty.</p>
    </div>
    {% endif %}
    
    <!-- Check brand_information -->
    {% if brand_information %}
    <div class="debug-box success">
        <h3>‚úÖ Brand Information Available</h3>
        <p><strong>Brand Name:</strong> {{ brand_information.name|default:"Not found" }}</p>
        <p><strong>Tagline:</strong> {{ brand_information.tagline|default:"Not found" }}</p>
        <p><strong>Phone:</strong> {{ brand_information.contact_info.phone|default:"Not found" }}</p>
        <p><strong>Email:</strong> {{ brand_information.contact_info.email|default:"Not found" }}</p>
    </div>
    {% else %}
    <div class="debug-box error">
        <h3>‚ùå Brand Information Missing</h3>
        <p>brand_information variable not found.</p>
    </div>
    {% endif %}

    <!-- Check lighting_specifications -->
    {% if lighting_specifications %}
    <div class="debug-box success">
        <h3>‚úÖ Lighting Specifications Available</h3>
        <p><strong>Total Cost:</strong> {{ lighting_specifications.overview.total_cost|default:"Not found" }}</p>
        <p><strong>Total Fixtures:</strong> {{ lighting_specifications.overview.total_fixtures|default:"Not found" }}</p>
    </div>
    {% else %}
    <div class="debug-box error">
        <h3>‚ùå Lighting Specifications Missing</h3>
        <p>lighting_specifications variable not found or empty.</p>
    </div>
    {% endif %}

    <!-- Check project_floor_plans -->
    {% if project_floor_plans %}
    <div class="debug-box success">
        <h3>‚úÖ Floor Plans Available</h3>
        <p><strong>Floor Plan Groups:</strong> {{ project_floor_plans|length }}</p>
    </div>
    {% else %}
    <div class="debug-box error">
        <h3>‚ùå Floor Plans Missing</h3>
        <p>project_floor_plans variable not found or empty.</p>
    </div>
    {% endif %}
    
    <!-- ‚úÖ FIXED - All Available Template Variables -->
    <div class="debug-box">
        <h3>üîß All Available Template Variables</h3>
        <p>Available sections from debug_info:</p>
        <ul>
        {% if debug_info.sections_available %}
            {% for section in debug_info.sections_available %}
                <li>{{ section }}</li>
            {% endfor %}
        {% else %}
            <li>No sections found or debug_info missing</li>
        {% endif %}
        </ul>
        
        <p>Template context keys:</p>
        <ul>
        {% if debug_info.context_keys %}
            {% for key in debug_info.context_keys %}
                <li>{{ key }}</li>
            {% endfor %}
        {% else %}
            <li>No context keys found</li>
        {% endif %}
        </ul>
    </div>

    <!-- ‚úÖ Validation Results -->
    {% if debug_info.validation_results %}
    <div class="debug-box">
        <h3>üîç Data Validation Results</h3>
        <p><strong>Project Info Valid:</strong> {{ debug_info.validation_results.project_info_valid|yesno:"‚úÖ Yes,‚ùå No" }}</p>
        <p><strong>Customer Info Valid:</strong> {{ debug_info.validation_results.customer_info_valid|yesno:"‚úÖ Yes,‚ùå No" }}</p>
        <p><strong>Calculations Valid:</strong> {{ debug_info.validation_results.calculations_valid|yesno:"‚úÖ Yes,‚ùå No" }}</p>
        <p><strong>Cabinet Data Valid:</strong> {{ debug_info.validation_results.cabinet_data_valid|yesno:"‚úÖ Yes,‚ùå No" }}</p>
        <p><strong>Accessories Data Valid:</strong> {{ debug_info.validation_results.accessories_data_valid|yesno:"‚úÖ Yes,‚ùå No" }}</p>
        <p><strong>Brand Info Valid:</strong> {{ debug_info.validation_results.brand_info_valid|yesno:"‚úÖ Yes,‚ùå No" }}</p>
    </div>
    {% endif %}
    
    <!-- ‚úÖ Summary Information -->
    <div class="debug-box">
        <h3>üìä Data Summary</h3>
        <p><strong>Customer Name:</strong> {{ debug_info.customer_name|default:"Not Available" }}</p>
        <p><strong>Quotation Number:</strong> {{ debug_info.quotation_number|default:"Not Available" }}</p>
        <p><strong>Final Total:</strong> {{ debug_info.final_total|default:"Not Available" }}</p>
        <p><strong>Cabinet Count:</strong> {{ debug_info.cabinet_count|default:"0" }}</p>
        <p><strong>Accessories Count:</strong> {{ debug_info.accessories_count|default:"0" }}</p>
        <p><strong>Floor Plans Count:</strong> {{ debug_info.floor_plans_count|default:"0" }}</p>
    </div>
    
    <!-- ‚úÖ Current Timestamp -->
    <div class="debug-box">
        <h3>‚è∞ Current Timestamp</h3>
        <p><strong>Generated at:</strong> 31 August 2025 at {{ debug_info.current_time_ist|default:"13:23:05 IST" }} by {{ debug_info.current_user|default:"Thaquidheen" }}</p>
        <p><strong>UTC Time:</strong> {{ debug_info.current_time_utc|default:"2025-08-31 07:53:05" }}</p>
        <p><strong>Template Method:</strong> {{ debug_info.template_context_method|default:"direct_assignment" }}</p>
        <p><strong>Template rendered successfully!</strong> üöÄ</p>
    </div>
</body>
</html>